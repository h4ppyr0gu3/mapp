.is-size-1 Editing Song

= render "form", song: @song

= link_to "Back to songs", songs_path, class: "button"

button.button#auto-fill Auto fill

#forming

javascript: 

  title = document.getElementById("title");
  artist = document.getElementById("artist");
  album = document.getElementById("album");
  year = document.getElementById("year");
  genre = document.getElementById("genre");
  auto = document.getElementById("auto-fill");
  form = document.getElementById("forming");

  auto.addEventListener("click", (e) => {
    e.preventDefault
    console.log("clicked");
    fetch(("http://localhost:3000/auto_fill?artist=" +
    encodeURIComponent(artist.value))).then(data => data.json())
    .then(data => artistDropdown(data))
    })

  function artistDropdown(data) {
      form.innerHTML = ""
      var selectList = "<div class='select'><select class='select' id='artist-select'>"
      for (var i = 0; i < data.artists.length; i++) {
          var option = document.createElement("option");
          selectList = selectList + "<option value='" + 
          data.artists[i].id+ "'>" + 
          data.artists[i].name + "</option>"
      }
      selectList = selectList + "</select></div><button class='button' id='artist-submit'>Artist</button>"
      form.innerHTML = selectList
      addListenersForArtist()
    }

    function addListenersForArtist() {
      artist_select = document.getElementById("artist-select")
      artist_submit = document.getElementById("artist-submit")
      artist_id = artist_select.options[0].value
      artist.value = artist_select.options[0].text
      artist_select.addEventListener("change", (e) => {
        artist_id = e.target.options[e.target.options.selectedIndex].value
        artist.value = e.target.options[e.target.options.selectedIndex].text
      })
      artist_submit.addEventListener('click', (e) => {
        e.preventDefault
        fetch(("http://localhost:3000/auto_fill?artist_id=" +
        artist_id + "&title=" + title.value))
        .then(data => data.json()).then(data => songDropdown(data))
      })
    }

    function songDropdown(data) {
      var selectSong = "<div class='select'><select id='song-select'>"
      for (var i = 0; i < data.tracks.length; i++) {
          var option = document.createElement("option");
          selectSong = selectSong + "<option value='" +
          data.tracks[i].id+ "'>" +
          data.tracks[i].title + "</option>"
      }
      selectSong = selectSong + "</select></div><button class='button' id='song-submit'>Song</button>"
      form.innerHTML += selectSong
      addEventListenersForSong()
    }

    function addEventListenersForSong() {
      song_select = document.getElementById("song-select")
      song_submit = document.getElementById("song-submit")
      song_id = song_select.options[0].value
      title.value = song_select.options[0].text
      song_select.addEventListener("change", (e) => {
        song_id = e.target.options[e.target.options.selectedIndex].value
        title.value = e.target.options[e.target.options.selectedIndex].text
      })
      song_submit.addEventListener('click', (e) => {
        e.preventDefault
        fetch(("http://localhost:3000/auto_fill?song_id=" +
        song_id)).then(data => data.json()).then(data => fillForm(data))
        console.log(song_id)
      })
      console.log(song_id)
    }

    function fillForm(data) {
      year.value = data.date
      genre.value = data.genre
      album.value = data.title
    }
